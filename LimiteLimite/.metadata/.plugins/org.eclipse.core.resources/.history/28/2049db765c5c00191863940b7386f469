package fr.formation.dao.hibernate;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import fr.formation.cartes.CarteMotDefini;
import fr.formation.dao.IDAOCarteMotDefini;
import fr.formation.factory.DBFactory;


public class DAOCarteMotDefiniHibernate implements IDAOCarteMotDefini {

	
	public List<CarteMotDefini> findAll() {
		// TODO Auto-generated method stub
		List<CarteMotDefini> mesCartesMotsDefinis = new ArrayList<CarteMotDefini>();
		
		try {
			//On ex�cute la requ�te, et on r�cup�re le r�sultat
			ResultSet myResult = DBFactory.createResultSet("SELECT * FROM CarteMotDefini");
			
			//Pour chaque ligne de r�sultat de la requ�te
			while (myResult.next()) {
				CarteMotDefini maCarteMotDefini = new CarteMotDefini();

				maCarteMotDefini.setId(myResult.getInt("CMO_ID"));
				maCarteMotDefini.setMot(myResult.getString("CMO_MOT"));
				
				
				//On ajoute le produit � la liste
				mesCartesMotsDefinis.add(maCarteMotDefini);
			}
		}

		catch (SQLException e) { //Oups, erreurs SQL ...
			e.printStackTrace();
		}
		
		
		return mesCartesMotsDefinis;
	}

	public CarteMotDefini save (CarteMotDefini entity) {
		try {
			
			if(entity.getId()==0) {
			//On pr�pare ce qui va nous servir � r�aliser une requ�te SQL
			DBFactory.execute("INSERT INTO CarteMotDefini"
					+ " ( CMO_MOT)"
					+ " VALUES ( ?)",
			
			//Associer les valeurs du produit � la requ�te
			entity.getMot());
			
			}
			else { 
			DBFactory.execute("UPDATE produit"
					+ " (CMO_MOT=?)"
					+ " VALUES ( ?) WHERE CMO_ID =?",
				
			//Associer les valeurs du produit � la requ�te
			entity.getMot(),
			entity.getId());	
			}

		}

		catch (Exception e) { //Oups, erreurs SQL ...
			e.printStackTrace();
		}
		
		
		return entity;
	}
	
	
	
	public CarteMotDefini findById(int id) {
		// TODO Auto-generated method stub
		return null;
	}

	
	public void delete(CarteMotDefini entity) {
		// TODO Auto-generated method stub
		try {
			DBFactory.execute("DELETE FROM CarteMotDefini WHERE CMO_ID = ?", entity.getId());
		}
		catch (Exception e) {
			e.printStackTrace();
		}
	}

	
	public void deleteById(int id) {
		// TODO Auto-generated method stub
		try {
			DBFactory.execute("DELETE FROM CarteMotDefini where CMO_ID = ?", id); 
						
		} catch (Exception e) { 
			e.printStackTrace();
		}
	}

}